
use empfaiz;
CREATE TABLE EMPLOYEE (
    EMPNO INT PRIMARY KEY,
    ENAME VARCHAR(255),
    MGR_NO INT,
    HIREDATE DATE,
    SAL DECIMAL(10, 2),
    DEPTNO INT,
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO)
);




CREATE TABLE PROJECT (
    PNO INT PRIMARY KEY,
    PLOC VARCHAR(255),
    PNAME VARCHAR(255)
    
);


CREATE TABLE DEPT (
    DEPTNO INT PRIMARY KEY,
    DNAME VARCHAR(255),
    DLOC VARCHAR(255)
);

CREATE TABLE INCENTIVES (
    EMPNO INT,
    INCENTIVE_DATE DATE,
    INCENTIVE_AMOUNT DECIMAL(10, 2),
    FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO)
);


CREATE TABLE ASSIGNED_TO (
    EMPNO INT,
    PNO INT,
    JOB_ROLE VARCHAR(255),
    PRIMARY KEY (EMPNO, PNO),
    FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO),
    FOREIGN KEY (PNO) REFERENCES PROJECT(PNO)
);



INSERT INTO PROJECT VALUES
(101, 'New York', 'Website Development'),
(102, 'London', 'Mobile App Development'),
(103, 'Paris', 'Database Migration');


INSERT INTO DEPT VALUES
(1, 'HR', 'BENGALURU '),
(2, 'Engineering', 'MYSURU'),
(3, 'Sales', 'HYDERABAD');

INSERT INTO EMPLOYEE  VALUES
(1001, 'John Doe', NULL, '2020-01-15', 80000, 1),
(1002, 'Jane Smith', 1001, '2019-03-22', 95000, 2),
(1003, 'Alice Brown', 1002, '2021-05-30', 70000, 3),
(1004, 'Bob White', 1001, '2022-07-10', 75000, 1),
(1005, 'Charlie Green', NULL, '2023-02-10', 60000, 2);


INSERT INTO INCENTIVES  VALUES
(1001, '2022-12-25', 5000),
(1002, '2023-06-15', 3000),
(1003, '2023-08-01', 4000),
(1004, '2023-10-05', 2000);

INSERT INTO ASSIGNED_TO VALUES
(1001, 101, 'Project Manager'),
(1002, 102, 'Senior Developer'),
(1003, 103, 'Database Administrator'),
(1004, 101, 'Junior Developer'),
(1005, 102, 'Intern');

-- ANWER TO QUERY 3----
SELECT DISTINCT T1.EMPNO
FROM ASSIGNED_TO T1
JOIN PROJECT T2 ON T1.PNO = T2.PNO
WHERE T2.PLOC IN ('BENGALURU', 'MYSURU', 'HYDERABAD');

-- ANSWER TO UERY 4----
SELECT E.EMPNO
FROM EMPLOYEE E
LEFT JOIN INCENTIVES I ON E.EMPNO = I.EMPNO
WHERE I.EMPNO IS NULL;

-- ANSWER TO QUERY 5--
SELECT
    		E.ENAME,
    		E.EMPNO,
    		D.DNAME,
    		A.JOB_ROLE,
    		D.DLOC AS Department_Location,
    		P.PLOC AS Project_Location
	FROM
    		EMPLOYEE E
	JOIN
    		DEPT D ON E.DEPTNO = D.DEPTNO
	JOIN
    		ASSIGNED_TO A ON E.EMPNO = A.EMPNO
	JOIN
    		PROJECT P ON A.PNO = P.PNO
	WHERE
    		D.DLOC = P.PLOC;




















